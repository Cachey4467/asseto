# 交易记录分页功能说明

## 概述

为了提升大数据量场景下的性能和用户体验，我们为交易记录查询接口添加了分页功能。

## API 变更

### 请求参数

**新增必选参数：**
- `page_index`: 页码，从0开始，默认为0
- `page_size`: 每页记录数，默认为20，最大值为1000

**移除参数：**
- `limit`: 已废弃，请使用 `page_size` 替代

**保留参数：**
- `userId`: 用户ID（必选）
- `accountId`: 账户ID（可选）
- `start_date`: 开始日期（可选）
- `end_date`: 结束日期（可选）

### 响应格式

```json
{
  "success": true,
  "data": [
    {
      "id": "transaction_id",
      "userId": "user_id",
      "accountId": "account_id",
      "description": "交易描述",
      "date": "2024-01-15T10:30:00",
      "direction": 0,
      "quantity": "100",
      "price": "150.50",
      "currency": "USD"
    }
  ],
  "pagination": {
    "page_index": 0,
    "page_size": 20,
    "total_count": 150,
    "total_pages": 8,
    "has_next": true,
    "has_prev": false
  }
}
```

### 分页信息说明

- `page_index`: 当前页码
- `page_size`: 每页记录数
- `total_count`: 总记录数
- `total_pages`: 总页数
- `has_next`: 是否有下一页
- `has_prev`: 是否有上一页

## 使用示例

### 获取第一页数据（默认20条）
```
GET /api/v1/transactions?userId=user123
```

### 获取指定页数据
```
GET /api/v1/transactions?userId=user123&page_index=1&page_size=10
```

### 带过滤条件的分页
```
GET /api/v1/transactions?userId=user123&accountId=account456&page_index=0&page_size=50&start_date=2024-01-01T00:00:00&end_date=2024-12-31T23:59:59
```

## 参数验证

- `page_index` 必须大于等于0
- `page_size` 必须在1到1000之间
- 如果参数无效，将返回400错误

## 前端集成

前端API服务已更新，支持新的分页参数：

```typescript
// 获取交易记录
const response = await apiService.getTransactions({
  userId: 'user123',
  page_index: 0,
  page_size: 20,
  accountId: 'account456' // 可选
});

// 响应包含分页信息
console.log(response.data.pagination);
```

## 测试

运行分页功能测试：

```bash
cd backend
python -m pytest test/test_pagination.py -v
```

## 兼容性

- 如果不提供分页参数，将使用默认值（page_index=0, page_size=20）
- 原有的 `limit` 参数已废弃，建议尽快迁移到新的分页参数
