# 资产树右键菜单功能说明

## 功能概述

本应用已成功集成了 `react-contexify` 库，实现了资产树的右键菜单功能，替换了原有的双击节点弹出对话框的操作方式。

## 主要改进

### 1. 用户体验提升
- **更直观的操作方式**：右键点击比双击更符合用户习惯
- **更清晰的操作选项**：菜单项带有图标，操作意图更明确
- **更快的操作响应**：无需先打开对话框再选择操作类型

### 2. 功能完整性
- ✅ **添加资产节点** - 手动添加新的子资产
- ✅ **导入长桥账户** - 通过长桥 API 导入账户数据  
- ✅ **删除资产节点** - 删除选中的资产节点

## 技术实现

### 核心组件

1. **AssetContextMenu.jsx** - 右键菜单组件
   - 使用 `react-contexify` 的 `Menu`、`Item`、`Separator` 组件
   - 集成 Ant Design 图标
   - 支持危险操作样式（删除选项）

2. **AssetActionModal.jsx** - 操作模态框组件
   - 根据 `actionType` 显示不同的表单内容
   - 支持三种操作类型：`add`、`import`、`delete`
   - 保持原有的表单验证和用户体验

3. **AssetDetailPanel.jsx** - 资产详情面板
   - 将 `onDoubleClick` 改为 `onRightClick`
   - 集成右键菜单事件处理
   - 管理模态框状态和操作类型

### 样式定制

在 `App.css` 中添加了自定义样式：
- 现代化的菜单外观
- 悬停效果和过渡动画
- 危险操作的特殊样式（红色文字和背景）

## 使用方法

1. **打开右键菜单**：在资产树中右键点击任意节点
2. **选择操作**：从菜单中选择相应的操作选项
3. **填写信息**：在弹出的模态框中填写必要信息
4. **确认操作**：点击确定按钮完成操作

## 代码示例

### 右键菜单定义
```jsx
<Menu id="asset-context-menu">
    <Item onClick={({ props }) => onAddAsset(props.node)}>
        <PlusOutlined style={{ marginRight: 8 }} />
        添加资产节点
    </Item>
    <Separator />
    <Item onClick={({ props }) => onImportLongbridge(props.node)}>
        <ImportOutlined style={{ marginRight: 8 }} />
        导入长桥账户
    </Item>
    <Separator />
    <Item onClick={({ props }) => onDeleteAsset(props.node)} className="react-contexify__item--danger">
        <DeleteOutlined style={{ marginRight: 8 }} />
        删除资产节点
    </Item>
</Menu>
```

### 右键事件处理
```jsx
const handleTreeRightClick = (info, event) => {
    event.preventDefault();
    setSelectedNode(info.node);
    showContextMenu({
        id: "asset-context-menu",
        event,
        props: {
            node: info.node,
        },
    });
};
```

## 依赖项

- `react-contexify`: 右键菜单库
- `@ant-design/icons`: 图标库
- `antd`: UI 组件库

## 注意事项

1. 确保在应用的根组件中包装了 `ContextMenuProvider`
2. 右键菜单的 ID 必须与 `showContextMenu` 调用中的 ID 一致
3. 删除操作使用了危险样式，提醒用户操作不可恢复
4. 所有表单验证和错误处理逻辑保持不变 